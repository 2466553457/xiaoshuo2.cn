<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>大说小莫</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", "Microsoft YaHei", sans-serif;
      }

      body {
        background-color: #f5f7fa;
        color: #333;
        line-height: 1.6;
        padding-bottom: 40px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      header {
        background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%);
        color: white;
        padding: 2rem 0;
        text-align: center;
        margin-bottom: 2.5rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        margin-bottom: 10px;
      }

      .logo i {
        font-size: 2.5rem;
        color: #ffd166;
      }

      h1 {
        font-size: 2.5rem;
        font-weight: 700;
        letter-spacing: 1px;
      }

      .subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
        font-weight: 300;
      }

      .bookshelf-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 15px;
      }

      h2 {
        font-size: 1.8rem;
        color: #2c3e50;
        border-left: 5px solid #3498db;
        padding-left: 15px;
      }

      .book-count {
        background-color: #3498db;
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.9rem;
      }

      .books-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 30px;
      }

      .book-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
      }

      .book-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
      }

      .book-cover {
        width: 100%;
        height: 280px;
        object-fit: cover;
        display: block;
      }

      .book-info {
        padding: 18px;
      }

      .book-title {
        font-weight: 700;
        font-size: 1.1rem;
        margin-bottom: 8px;
        color: #2c3e50;
        line-height: 1.3;
        height: 2.6em;
        overflow: hidden;
      }

      .book-author {
        color: #7f8c8d;
        font-size: 0.9rem;
        margin-bottom: 10px;
      }

      .book-categories {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        margin-top: 5px;
      }

      .book-category {
        display: inline-block;
        font-size: 0.75rem;
        padding: 3px 10px;
        border-radius: 12px;
        font-weight: 500;
      }

      /* 不同分类的颜色 */
      .category-fantasy {
        background-color: #ffeaa7;
        color: #d35400;
      }

      .category-romance {
        background-color: #fab1a0;
        color: #c23616;
      }

      .category-mystery {
        background-color: #a29bfe;
        color: #2c3e50;
      }

      .category-sci-fi {
        background-color: #74b9ff;
        color: #1e3799;
      }

      .category-gaoxiao {
        background-color: #79fdfd;
        color: #21226d;
      }

      .category-action {
        background-color: #fd79a8;
        color: #6d214f;
      }

      .category-kongbu {
        background-color: #000000;
        color: #ffffff;
      }

      .category-lingyi {
        background-color: #b8d82a;
        color: #21686d;
      }

      .category-history {
        background-color: #55efc4;
        color: #006266;
      }

      .new-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        background-color: #e74c3c;
        color: white;
        font-size: 0.7rem;
        padding: 4px 10px;
        border-radius: 10px;
        font-weight: bold;
      }

      footer {
        text-align: center;
        margin-top: 4rem;
        color: #7f8c8d;
        font-size: 0.9rem;
        padding-top: 2rem;
        border-top: 1px solid #eaeaea;
      }

      .loading {
        text-align: center;
        padding: 2rem;
        color: #7f8c8d;
      }

      /* 响应式设计 */
      @media (max-width: 768px) {
        .books-grid {
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 20px;
        }

        h1 {
          font-size: 2rem;
        }

        .book-cover {
          height: 240px;
        }
      }

      @media (max-width: 480px) {
        .books-grid {
          grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
          gap: 15px;
        }

        h1 {
          font-size: 1.8rem;
        }

        .book-cover {
          height: 210px;
        }

        .book-info {
          padding: 12px;
        }
      }

      /* 书籍详情页链接样式 */
      .book-link {
        text-decoration: none;
        color: inherit;
        display: block;
      }

      /* 点击效果 */
      .book-card:active {
        transform: scale(0.98);
      }

      /* 筛选器样式 */
      .filters {
        display: flex;
        gap: 10px;
        margin-bottom: 25px;
        flex-wrap: wrap;
      }

      .filter-btn {
        padding: 8px 16px;
        border: none;
        background-color: #ecf0f1;
        color: #34495e;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 0.9rem;
      }

      .filter-btn:hover {
        background-color: #d5dbdb;
      }

      .filter-btn.active {
        background-color: #3498db;
        color: white;
      }

      /* 多标签筛选提示 */
      .filter-info {
        background-color: #f8f9fa;
        padding: 12px 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        border-left: 4px solid #3498db;
        font-size: 0.95rem;
      }

      .filter-info i {
        color: #3498db;
        margin-right: 8px;
      }

      /* 选中的分类标签 */
      .selected-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      .selected-filter {
        background-color: #3498db;
        color: white;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .remove-filter {
        cursor: pointer;
        font-size: 0.9rem;
      }

      /* 更新公告按钮 */
      .gengxin {
        background-color: #28a046;
        color: #ffffff;
        width: 100px;
        height: 40px;
        display: inline-block;
        vertical-align: middle;
        transform: perspective(1px) translateZ(0);
        box-shadow: 0 0 1px rgba(0, 0, 0, 0);
        transition-duration: 0.3s;
        transition-property: transform;
      }
      .gengxin:hover {
        background-color: #485fdf;
        cursor: pointer;
        transform: scale(1.1);
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="logo">
          <i class="fas fa-book-open"></i>
          <h1>大说小莫</h1>
        </div>
        <p class="subtitle">
          探索精彩故事，沉浸阅读世界 | 点击书籍封面开始阅读
        </p>
      </div>
    </header>

    <main class="container">
      <p>
        点击查看：<a
          href="gengxin.html"
          target="_blank"
          style="text-decoration: none; color: #ffffff"
          ><button class="gengxin">更新公告</button></a
        >
      </p>
      <hr />
      <div class="bookshelf-header">
        <h2>热门推荐</h2>
        <div class="book-count">共 <span id="count">12</span> 本书籍</div>
      </div>

      <div class="filter-info">
        <i class="fas fa-info-circle"></i>
        每本书籍可拥有多个分类标签。点击下方分类按钮进行筛选，可多选。当前选中：<span
          id="activeFilters"
          >全部</span
        >
        <div class="selected-filters" id="selectedFilters"></div>
      </div>

      <div class="filters">
        <button class="filter-btn active" data-filter="all">全部</button>
        <button class="filter-btn" data-filter="fantasy">玄幻</button>
        <button class="filter-btn" data-filter="kongbu">恐怖</button>
        <button class="filter-btn" data-filter="romance">言情</button>
        <button class="filter-btn" data-filter="mystery">悬疑</button>
        <button class="filter-btn" data-filter="sci-fi">都市</button>
        <button class="filter-btn" data-filter="gaoxiao">搞笑</button>
        <button class="filter-btn" data-filter="lingyi">灵异</button>
        <button class="filter-btn" data-filter="action">武侠</button>
        <button class="filter-btn" data-filter="history">历史</button>
      </div>

      <div class="books-grid" id="booksGrid">
        <!-- 书籍卡片将通过JavaScript动态生成 -->
      </div>

      <div class="loading" id="loading">
        <i class="fas fa-spinner fa-spin"></i> 加载书籍中...
      </div>
    </main>

    <footer class="container">
      <p>小说书架 &copy; 2025 | 本页面仅供开发者使用，小说来自网络</p>
      <p>点击任意书籍封面将在新窗口打开详情页面</p>
    </footer>

    <script>
      // 模拟书籍数据 - 每本书可以有多个分类
      const books = [
        {
          id: 1,
          title: "东北90年代白事先生",
          author: "滨城老三",
          categories: ["mystery", "gaoxiao", "kongbu", "lingyi"],
          cover: "imgs/db90ndbsxs.jpg",
          isNew: true,
          url: "dbbsxs.html",
        },
        {
          id: 2,
          title: "都是地府惹的祸",
          author: "吴半仙",
          categories: ["sci-fi", "lingyi", "mystery", "gaoxiao"],
          cover: "imgs/difurehuo.jpg",
          isNew: false,
          url: "dsdfrdh.html",
        },
        {
          id: 3,
          title: "东北出马笔记",
          author: "吴半仙",
          categories: ["mystery", "gaoxiao", "kongbu", "lingyi"],
          cover: "imgs/dbcmbj.jpg",
          isNew: false,
          url: "dbcmbj.html",
        },
        {
          id: 4,
          title: "东北灵异档案",
          author: "爱会永恒",
          categories: ["mystery", "sci-fi", "lingyi", "kongbu"],
          cover: "imgs/dblyda.jpg",
          isNew: false,
          url: "dblyda.html",
        },
        {
          id: 5,
          title: "借命",
          author: "桃花十里",
          categories: ["mystery", "lingyi", "kongbu", "romance"],
          cover: "imgs/jm.jpg",
          isNew: false,
          url: "jm.html",
        },
        {
          id: 6,
          title: "代理阎王",
          author: "一柱老孤烟",
          categories: ["sci-fi", "fantasy", "gaoxiao", "lingyi"],
          cover: "imgs/dlyw.jpg",
          isNew: false,
          url: "dlyw.html",
        },
        {
          id: 7,
          title: "极度尸寒",
          author: "全雨",
          categories: ["mystery", "kongbu", "lingyi", "sci-fi"],
          cover: "imgs/jdsh.jpg",
          isNew: false,
          url: "jdsh.html",
        },
        {
          id: 8,
          title: "乡村怪谈",
          author: "亦假亦真",
          categories: ["mystery", "kongbu", "lingyi", "gaoxiao"],
          cover: "imgs/xcgt123.jpg",
          isNew: false,
          url: "xcgt.html",
        },
      ];

      // 分类映射
      const categoryMap = {
        fantasy: "玄幻",
        kongbu: "恐怖",
        romance: "言情",
        mystery: "悬疑",
        "sci-fi": "都市",
        gaoxiao: "搞笑",
        lingyi: "灵异",
        action: "武侠",
        history: "历史",
      };

      // 存储当前选中的筛选条件
      let activeFilters = new Set(["all"]);

      // 页面加载完成后初始化
      document.addEventListener("DOMContentLoaded", function () {
        const booksGrid = document.getElementById("booksGrid");
        const loadingElement = document.getElementById("loading");
        const countElement = document.getElementById("count");
        const filterButtons = document.querySelectorAll(".filter-btn");
        const activeFiltersElement = document.getElementById("activeFilters");
        const selectedFiltersElement =
          document.getElementById("selectedFilters");

        // 初始化显示所有书籍
        renderBooks(books);
        updateSelectedFiltersDisplay();

        // 更新书籍计数
        countElement.textContent = books.length;

        // 隐藏加载指示器
        loadingElement.style.display = "none";

        // 筛选按钮事件
        filterButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const filter = this.getAttribute("data-filter");

            // 处理"全部"按钮
            if (filter === "all") {
              activeFilters.clear();
              activeFilters.add("all");

              // 更新按钮状态
              filterButtons.forEach((btn) => {
                btn.classList.remove("active");
                if (btn.getAttribute("data-filter") === "all") {
                  btn.classList.add("active");
                }
              });
            } else {
              // 移除"全部"选项
              activeFilters.delete("all");

              // 切换当前筛选条件
              if (activeFilters.has(filter)) {
                activeFilters.delete(filter);
                this.classList.remove("active");
              } else {
                activeFilters.add(filter);
                this.classList.add("active");
              }

              // 如果没有选中任何筛选条件，则选择"全部"
              if (activeFilters.size === 0) {
                activeFilters.add("all");
                filterButtons.forEach((btn) => {
                  btn.classList.remove("active");
                  if (btn.getAttribute("data-filter") === "all") {
                    btn.classList.add("active");
                  }
                });
              } else {
                // 确保"全部"按钮不是激活状态
                document
                  .querySelector('.filter-btn[data-filter="all"]')
                  .classList.remove("active");
              }
            }

            // 应用筛选
            applyFilters();
            updateSelectedFiltersDisplay();
          });
        });

        // 应用筛选条件
        function applyFilters() {
          // 如果选择了"全部"或者没有选择任何条件
          if (activeFilters.has("all") || activeFilters.size === 0) {
            renderBooks(books);
            return;
          }

          // 筛选书籍：至少包含一个当前选中的分类
          const filteredBooks = books.filter((book) => {
            return book.categories.some((category) =>
              activeFilters.has(category)
            );
          });

          renderBooks(filteredBooks);
        }

        // 渲染书籍函数
        function renderBooks(bookList) {
          booksGrid.innerHTML = "";

          // 如果没有匹配的书籍
          if (bookList.length === 0) {
            booksGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #7f8c8d;">
                            <i class="fas fa-book" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <h3>没有找到匹配的书籍</h3>
                            <p>请尝试选择其他分类</p>
                        </div>
                    `;
            return;
          }

          bookList.forEach((book) => {
            const bookCard = document.createElement("div");
            bookCard.className = "book-card";

            // 生成分类标签HTML
            const categoriesHTML = book.categories
              .map((category) => {
                const categoryText = categoryMap[category] || category;
                return `<span class="book-category category-${category}">${categoryText}</span>`;
              })
              .join("");

            bookCard.innerHTML = `
                        <a href="${book.url}" target="_blank" class="book-link">
                            ${
                              book.isNew
                                ? '<span class="new-badge">新书</span>'
                                : ""
                            }
                            <img src="${book.cover}" alt="${
              book.title
            }" class="book-cover">
                            <div class="book-info">
                                <h3 class="book-title">${book.title}</h3>
                                <p class="book-author">${book.author}</p>
                                <div class="book-categories">
                                    ${categoriesHTML}
                                </div>
                            </div>
                        </a>
                    `;

            // 添加点击效果
            bookCard.addEventListener("click", function (e) {
              // 防止链接被多次触发
              if (e.target.tagName === "A") return;

              // 添加点击反馈
              this.style.transform = "scale(0.98)";
              setTimeout(() => {
                this.style.transform = "";
              }, 150);

              // 模拟打开新页面（实际中由链接完成）
              console.log(`正在打开《${book.title}》的详情页面...`);
            });

            booksGrid.appendChild(bookCard);
          });
        }

        // 更新选中的筛选条件显示
        function updateSelectedFiltersDisplay() {
          // 更新文本显示
          if (activeFilters.has("all") || activeFilters.size === 0) {
            activeFiltersElement.textContent = "全部";
            selectedFiltersElement.innerHTML = "";
            return;
          }

          // 生成选中的筛选标签
          const filtersArray = Array.from(activeFilters);
          const filtersText = filtersArray
            .map((filter) => categoryMap[filter] || filter)
            .join("、");
          activeFiltersElement.textContent = filtersText;

          // 生成可移除的标签
          selectedFiltersElement.innerHTML = "";
          filtersArray.forEach((filter) => {
            const filterElement = document.createElement("div");
            filterElement.className = "selected-filter";
            filterElement.innerHTML = `
                        ${categoryMap[filter] || filter}
                        <span class="remove-filter" data-filter="${filter}">&times;</span>
                    `;
            selectedFiltersElement.appendChild(filterElement);
          });

          // 为移除按钮添加事件
          document.querySelectorAll(".remove-filter").forEach((btn) => {
            btn.addEventListener("click", function (e) {
              e.stopPropagation();
              const filterToRemove = this.getAttribute("data-filter");

              // 从当前筛选中移除
              activeFilters.delete(filterToRemove);

              // 如果没有选中任何筛选条件，则选择"全部"
              if (activeFilters.size === 0) {
                activeFilters.add("all");
                filterButtons.forEach((btn) => {
                  btn.classList.remove("active");
                  if (btn.getAttribute("data-filter") === "all") {
                    btn.classList.add("active");
                  }
                });
              } else {
                // 更新按钮状态
                document
                  .querySelector(`.filter-btn[data-filter="${filterToRemove}"]`)
                  .classList.remove("active");
              }

              // 应用筛选
              applyFilters();
              updateSelectedFiltersDisplay();
            });
          });
        }

        // 显示初始化完成消息
        console.log(
          "多标签小说书架已加载完成！每本书籍可拥有多个分类标签，支持多选筛选。"
        );
      });
    </script>
  </body>
</html>
